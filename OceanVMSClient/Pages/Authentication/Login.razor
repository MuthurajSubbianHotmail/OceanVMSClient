@page "/login"
@using MudBlazor


<div class="login-page">
    <div class="card login-card">
        <div class="login-brand">
            <h1>Ocean VMS</h1>
            <div style="font-size:0.85rem;opacity:.95">Welcome back — sign in to continue</div>
        </div>

        <div class="login-body">
            @if (ShowAuthError)
            {
                <div class="alert alert-danger" role="alert">
                    <p class="mb-0">@ErrorMessage</p>
                </div>
            }

            <EditForm Model="_userForAuthentication" OnValidSubmit="HandleSubmit" class="card card-body bg-light mt-4">
                <DataAnnotationsValidator />
                <ValidationSummary class="text-danger" />

                <div class="mb-3">  
                    <MudTextField T="string"
                                  Label="User name"
                                  Placeholder="Enter your username"
                                  Typo="Typo.caption"
                                  Adornment="Adornment.End"
                                  AdornmentIcon="@Icons.Material.Filled.Person"
                                  Immediate="true"
                                  Class="w-100"
                                  @bind-Value="_userForAuthentication.UserName" />
                    <ValidationMessage For="@(() => _userForAuthentication.UserName)" />
                </div>

                <div class="mb-3">
                    <MudTextField T="string"
                                  Label="Password"
                                  Placeholder="Enter your password"
                                  Typo="Typo.caption"
                                  Class="w-100"
                                  InputType="@(showPassword ? InputType.Text : InputType.Password)"
                                  Adornment="Adornment.End"
                                  AdornmentIcon="@(showPassword ? Icons.Material.Filled.Visibility : Icons.Material.Filled.VisibilityOff)"
                                  OnAdornmentClick="ToggleShowPassword"
                                  Immediate="true"
                                  @bind-Value="_userForAuthentication.Password" />
                    <ValidationMessage For="@(() => _userForAuthentication.Password)" />
                </div>

                <div class="d-flex justify-content-between align-items-center mb-3">
                    <div class="form-check">
                        <InputCheckbox id="remember" class="form-check-input" @bind-Value="rememberMe" />
                        <label class="form-check-label" for="remember">Remember me</label>
                    </div>
                    <a class="small" href="/forgot-password">Forgot password?</a>
                </div>

                <div class="d-grid">
                    <button class="btn btn-primary btn-lg" type="submit" disabled="@isSubmitting">
                        @if (isSubmitting)
                        {
                            <MudProgressCircular Size="Size.Small" Indeterminate="true" Class="me-2" Color="Color.Inherit" />
                            <span>Signing in...</span>
                        }
                        else
                        {
                            <span>Sign in</span>
                        }
                    </button>
                </div>
            </EditForm>

            <div class="text-center mt-3 small text-muted">
                By signing in you agree to the <a href="#" class="text-decoration-underline">terms</a>.
            </div>
        </div>
    </div>
</div>

